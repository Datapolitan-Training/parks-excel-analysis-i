<!DOCTYPE html>
<html>
  <head>
    <title>Excel for Data Analysis I - NYC Parks</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="slide.css"/>
  </head>
  <body>
    <textarea id="source">

layout:true

<div class="header" style="display:block; text-align: left; color:gray; font-size:1em; position: fixed; top: 0px; left: 0px; height: 30px;vertical-align:middle;margin:7px 0 0 0;width:100%;background: #fcfcfc;
background: -moz-linear-gradient(top, #fcfcfc 0%, #d1d1d1 100%); 
background: -webkit-linear-gradient(top, #fcfcfc 0%,#d1d1d1 100%);
background: linear-gradient(to bottom, #fcfcfc 0%,#d1d1d1 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fcfcfc', endColorstr='#d1d1d1',GradientType=0 );">
  <img src="images/datapolitan_transparent_small.png" style="position: fixed;top: 2px; left: 5px; width: 14%;">
  <p style="display:block;text-align:left;color:gray;font-size:1em; position: fixed; top: 0px; left: 155px; height: 30px;vertical-align:middle;margin:7px 0 0 0; ">Excel for Data Analysis I - NYC Parks and Recreation</p>
</div>
<div class="footer" style="display:block;color:gray;position:fixed;bottom: 0px;left:0px;height:30px;vertical-align:middle;margin:0 0 0 0;width:100%;background: #fcfcfc;background: -moz-linear-gradient(top, #fcfcfc 0%, #d1d1d1 100%);background: -webkit-linear-gradient(top, #fcfcfc 0%,#d1d1d1 100%);background: linear-gradient(to bottom, #fcfcfc 0%,#d1d1d1 100%);sfilter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fcfcfc', endColorstr='#d1d1d1',GradientType=0 );">
  <p class="footer">
    <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Excel for Data Analysis I</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.datapolitan.com" target="_blank" property="cc:attributionName" rel="cc:attributionURL">Richard Dunks</a> and <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.tinypanther.com" property="cc:attributionName" rel="cc:attributionURL">Julia Marden</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative-Commons-License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
  </p>
</div>

<!-- <p class="footer">
<span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Data Analytics for NYC Parks</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.datapolitan.com" property="cc:attributionName" rel="cc:attributionURL">Richard Dunks</a> and <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.tinypanther.pizza" property="cc:attributionName" rel="cc:attributionURL">Julia Marden</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative-Commons-License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
</p> -->

--

class:center, middle
![img-center-50](images/datapolitan.png)

# Excel for Data Analysis I<br>City of New York Parks and Recreation

- - -

## Instructors: Richard Dunks and Elana Shneyer
### Follow along at: http://bit.ly/excel-analysis-i

---

class:center,middle

<!-- start of A block -->
# Welcome

---

# A Few Ground Rules
+ Step up, step back
+ Be curious and ask questions!
+ Assume noble regard and positive intent
+ Respect multiple perspectives 
+ Listen deeply
+ Be present (phone, email, social media, etc.)

---

# Introduce Yourself to Your Neighbor
+ Who are you?
+ Where do you work?
+ What has been the proudest moment in your job?
+ What's your favorite park?

???
+ An opportunity for participants to get to know each other and settle into the class
+ We bring them into a positive space related to their work
+ Facilitator reminds them the data isn't the end but the means to achieve the actions that make us feel good about our jobs

---

# Housekeeping
+ We’ll have one 15 minute break in the morning
+ We’ll have an hour for lunch
+ We’ll have a 15 minute break in the afternoon
+ Class will start promptly after breaks
+ Feel free to use the bathroom if you need during class
+ Please take any phone conversations into the hall to not disrupt the class

???
+ Facilitator sets expectations with the students
+ Establishes the "contract" for the class

---

class:center,middle
# Let's Get Started
## [Click to download this data](data/Exercise1.xlsx)

---

# Borough with the Most NYC Parks 311 Service Requests
+ How are we going to answer this question with the data we have?
![img-center-70](images/parks_311_boro.png)

---

class:center,middle
# Overview of Excel

---

# Benefits of Excel
+ Easy to use
+ Very visual
+ Lots of features and functions
+ Easy to make charts
+ Does a lot of formatting for you

???
+ Poll class for their key challenges working with Excel
+ Discuss the ways in which Excel is beneficial in daily work

---

# Drawbacks of Excel
+ Not very intuitive
+ Hard to find what you’re looking for (and they keep moving things around)
+ Lots of features and functions
+ Easy to make (bad) charts
+ Does a lot of formatting for you

???
+ Poll class for their key challenges working with Excel
+ Discuss the ways in which Excel is challenging in their daily work

---

class:center,middle
<!-- end of A block -->
# Wrap-up

---

class:center,middle
# 15 MIN BREAK

---

<!-- start of B block -->

# The Value of Data
+ Data tells a story about something that's happened
+ Can describe the what happened directly or indirectly

![img-center-90](images/311data_rev.png)

---

class: center,middle
# Are All Data Points Created Equal?

---

class:middle
> Facts do not "speak for themselves." They speak for or against competing theories. Facts divorced from theory or visions are mere isolated curiosities.

## -Thomas Sowell *A Conflict of Visions*

---

# What is Analysis?
--

>“Analysis is simply the pursuit of understanding, usually through detailed inspection or comparison”

## - Carter Hewgley, Director of Analytics, [Center for Government Excellence](https://govex.jhu.edu/)

---

class:center, middle
# Data Analysis Should Drive Decision Making
# &nbsp;
## &nbsp;

---

class:center, middle
# Data Analysis Should Drive Decision Making
# This is what it means to be "data driven"
## &nbsp;

---

class:center, middle
# Data Analysis Should Drive Decision Making
# This is what it means to be "data driven"
## And good analysis should lead to good decisions

---
name:avp
# But It's Just One Part of a Process

![img-center-80](images/valuechain.png)

???
+ Facilitator introduces the idea of the Analytics Value Chain

---
exclude:true
class: middle
> "If you do not know how to ask the right question, you discover nothing."

## - W. Edward Deming

---
class:center,middle
<!-- end of B block -->
# Wrap-Up

---

class:center,middle
# LUNCH

---

class:center, middle
# WELCOME BACK!

---

class:center,middle
# Let's Get Some Data

---

exclude:true
# Definition of Open Data

> Open data is data that can be freely used, shared and built-on by anyone, anywhere, for any purpose

## - [Open Knowledge International](http://blog.okfn.org/2013/10/03/defining-open-data/)

---
exclude:true
# Key Features of Open Data
+ Availability and access
+ Reuse and redistribution
+ Universal participation

---

exclude:true
# Open Data Benefits
+ Transparency
+ Releasing social and commercial value
+ Participation and engagement

---

exclude:true
# Keeping NYC Accountable on Parking Tickets

![img-center-75](images/nyc_parking_ticket.jpg)
.caption[Image Credit: Parking Violator by [Atomische * Tom Giebel](https://www.flickr.com/photos/atomische/2299948817/), [CC BY-NC-ND 2.0 ](https://creativecommons.org/licenses/by-nc-nd/2.0/)]

Source: http://iquantny.tumblr.com/post/87573867759/success-how-nyc-open-data-and-reddit-saved-new

---

exclude:true
# Open Data Concerns
+ Privacy (Personally identifiable information (PII), Mosaic Effect)
+ Confidentiality
+ Security

---

exclude:true
# When Good Data Goes Bad

![img-center-70](images/nyctaxi.jpeg)
.caption[Image Credit: Kenny Louie, [CC BY 2.0](http://creativecommons.org/licenses/by/2.0), via [Wikimedia Commons](https://commons.wikimedia.org/wiki/File%3ANYC_TAXI_(7038011669).jpg)]

[Gawker matches Taxi and Limousine Data with Paparazzi Photos](http://gawker.com/the-public-nyc-taxicab-database-that-accidentally-track-1646724546)

---

class:center,middle
# We're going to be using data from the<br> <a href="https://opendata.cityofnewyork.us/" target="_blank">NYC Open Data Portal</a> for the first part of today's data exercise

## We'll be using <br>FY2016-2017 Daily Tasks Park Cleaning Records

---

# Data for Exercise
![img-center-100](images/dt_download.png)

#### [Click to download if you have problems](data/20160601_20160630_Daily_Tasks_Park_Cleaning_Records.csv)

---

exclude:true
# To Err is Human

> Since 1995, 88% of the 113 spreadsheets audited in 7 studies ... have contained errors.

## - Raymond Panko, "[What We Know About Spreadsheet Errors](http://panko.shidler.hawaii.edu/My%20Publications/Whatknow.htm)"

---

exclude:true
# Spreadsheet Errors Have Consequences

![img-center-80](images/athensprotest.jpg)
.caption[Image Credit: [http://underclassrising.net](https://www.flickr.com/photos/0742/4163565280), [CC BY-SA 2.0](https://creativecommons.org/licenses/by-sa/2.0/)]

---

exclude:true
# Finding Context

![img-center-80](images/context.png)

---

exclude:true
# Exploratory Data Analysis
+ Goal -> Discover patterns in the data
+ Understand the context
+ Summarize fields
+ Use graphical representations of the data
+ Explore outliers

####Tukey, J.W. (1977). Exploratory data analysis. Reading, MA: Addison-Wesley

---

# Steps to Prepare This Data
--

+ Filter for "Work" as the `activity`
--

+ Summarize by Park
--

+ Find the Borough for Each Site
--

+ Visualize Results

???
+ Task: Students follow a guided exercise in key data manipulation tasks using data related to the challenge, including 
+ Formatting
+ Sorting/filtering
+ Aggregating (PivotTables)
+ Cleaning/manipulating
+ Visualizing
+ Outcome: Students are practiced in key data analytics task with Parks-specific data following the general outlines of the problem ideation and process mapping work they performed in the morning
+ Format: Guided exercise and facilitated discussion
+ Outline
+ Introduction to key analytical questions
+ Guided task demonstration
+ Wrap-up


---

# Filter the Activity Column

![img-center-80](images/filter1_rev.png)

---

# Filter the Activity Column

![img-right-40](images/filter2_rev_trim.png)
+ Uncheck "Select All"
+ Check "Work"
--

+ The color of row labels will change to show you're filtering rows

![img-left-50](images/filter3_box_rev.png)

---

# PivotTables
--

+ A data summarization and comparison tool for quickly understanding and displaying the data you’re analyzing
--

+ Find it on the Insert ribbon
--


![img-center-60](images/pivottable1.png)

---

# PivotTables
![img-right-50](images/pivottable2.png)
+ Select the range and destination
--

+ Should default to all your data and a new sheet

---

# PivotTables
![img-right-30](images/pivottable3_border.png)
--

+ Click and drag the column headers into the boxes
--

+ **Filters** -> allows you to filter on the values in that field
--

+ **Rows** -> puts the values of that field in the rows of the pivottable
--

+ **Columns** -> puts the values of that field into the columns of the pivottable
--

+ **Values** -> determines how the values of the rows and columns are counted

---

# Summarize by Park
+ What are some of the questions you'd like to know by property?

![img-center-70](images/hours_worked_borough.png)

???
+ A short brainstorming exercise for the different operations that can be performed on the data

---

# Finding the Borough for Each Site
--

+ What if we want to aggregate by borough?
--

+ Can we do that easily with this data?

---

# Functions in Excel
--

+ Allow you to do calculations in Excel
--

+ Also allow you to manipulate text
--

+ And a whole lot more...

---

name:cat-function
# Some Categories of Functions in Excel
--

+ Database functions
--

+ Date and time functions
--

+ Financial functions
--

+ Logical functions
--

+ Lookup and reference functions
--

+ Math and trigonometry functions
--

+ Statistical functions
--

+ Text functions
--

+ 13 categories in total
--

+ [Click for a list of some useful functions](#excel-guide)

---

# Extracting the Borough
--

+ Insert a new column after `district`
--

+ Call it `Borough`
--

+ Insert the following formula into cell .blue[I2]
--

```
=LEFT(H2,1)
```
--
+ Copy the formula down through all the cells
--

+ More information on the [LEFT function](https://support.office.com/en-us/article/LEFT-LEFTB-functions-9203d2d2-7960-479b-84c6-1ea52b99640c)

---

# Extracting the Borough
![img-right-35](images/pivottable4_refresh.png)
+ Be sure to refresh your pivottable
--

+ Filter on activity `Work` and sum by number of hours

![img-center-30](images/pivottable5_box.png)
--

+ Filter out the empty value

---

# Extracting the Borough
--

+ You can retype entries in a pivottable
--

+ For example, you can change the boroughs just by typing over the letters
--


![img-center-100](images/pivottable6_rev.png)

---

# Extracting the Borough
+ You could also write a formula

```
=IF(LEFT(H2,1)="M","Manhattan",
	IF(LEFT(H2,1)="X","Bronx",
	IF(LEFT(H2,1)="B","Brooklyn",
	IF(LEFT(H2,1)="Q","Queens",
	IF(LEFT(H2,1)="R","Staten Island","")))))
```
--
<a href="https://giphy.com/gifs/reaction-office-space-that-was-easy-zcCGBRQshGdt6"><iframe src="https://giphy.com/embed/zcCGBRQshGdt6" width="400" height="228" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></a>

#### [Sheet with formulas](data/20160601_20160630_Daily_Tasks_Park_Cleaning_Records_formulas.xlsx)
---

class:center,middle
# 15 MIN BREAK

---

exclude:true
class:center,middle
# Supervisor Inspections
## [Click to download the Sites Data](data/AMPSInsExtract_Jun2016_Sites_20170613.csv)<br>[Click to download the Features Data](data/AMPSInsExtract_Jun2016_Features_20170613.csv)

## You can find this on the Intranet: http://wss.parks.nycnet/IPM/default.aspx

---

name:final-ex
# Your Turn
--

+ Take the problem you defined
--

+ Follow your map
--

+ We'll be here to help
--

+ Make sure you're documenting your steps and save your work
--

+ Someone is going to come behind you to look at and explain your work
--

+ Feel free to use the [list of useful functions](#excel-guide)


???
+ Task: Students work as a group to develop key insights and tell the story as it relates to the problem defined in the morning session, documenting their work as they go for presentation to their fellow students
+ Outcome: Students have implemented the process they outlined in morning session and documented their steps for review and feedback from their peers
+ Format: Mentored small group work
+ Outline
+ Introduction to task
+ Small group work

---

# Verification
+ Review the documentation the group provided
+ Rerun the analysis (without losing their work)
+ Be ready to present their work to the class

???
+ Task: As a group, review the work of another group, reviewing documentation and verifying analytical steps for accuracy, completeness, and ability to answer the initial question
+ Outcome: Students practice reviewing documentation and communicating findings to an audience, as well as giving and receiving constructive feedback in a supportive environment
+ Format: Small group presentations and facilitated discussion
+ Outline
+ Students as a group review the work of another group and verifying results
+ Students present the work of the group they reviewed to the class for brief discussion and feedback


---

exclude:true
# Links to Other Open Data Portals
+ New York State - https://data.ny.gov
+ US Federal Government - https://www.data.gov/


---

class:center,middle
# WRAP-UP

---

# What We've Covered

---

name:final
# Final Thoughts
--

+ Don't try to boil the ocean
--

+ Data can tell a story, but doesn't speak for itself
--

+ Good analysis is about telling a true and compelling story
--

+ Be good to your data and it will be good to you
--

+ Try to focus on outcomes, not just outputs

---

# Resources
--

+ [Microsoft Office Support](http://office.microsoft.com/en-us/support/) - Documentation on various MS Office products
--

+ [Excel Tips](http://excel.tips.net/) - Various tips and tricks for using Excel
--

+ [Data Science Cheatsheet](https://github.com/govex/Data-Science) - Includes various terms and concepts related to data science

---

# Resources
+ Carl Anderson [_Creating a Data-Driven Organization_](http://shop.oreilly.com/product/0636920035848.do)
--

+ DJ Patil & Hilary Mason [_Data Driven: Creating a Data Culture_](https://www.oreilly.com/ideas/data-driven)
--

+ [Copy of today's handout](workbook.pdf)
--

+ [Datapolitan training classes](http://training.datapolitan.com/)

---

## Contact Information
## Richard Dunks
+ Email: richard[at]datapolitan[dot]com
+ Website: http://www.datapolitan.com
+ Twitter: [@datapolitan](https://twitter.com/datapolitan)

## Elana Shneyer
+ Email: elana[at]datapolitan[dot]com

---

class:center, middle
# THANK YOU!

# Please take a moment to <br>[provide your feedback](https://docs.google.com/forms/d/e/1FAIpQLSeUDqtgW0dwPberYpPDeh8UQ3OxDkd2YsrAqcUoJT1y1SNZQg/viewform?usp=sf_link)




    </textarea>
    <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create(
        // {
        //   slideNumberFormat: ""}
        );
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-55673554-2', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>